<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SYNK STORE | Digital Asset Vault</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Space Grotesk', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        zinc: {
                            850: '#202023',
                            900: '#18181b',
                            950: '#09090b',
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'marquee': 'marquee 25s linear infinite',
                    },
                    keyframes: {
                        marquee: {
                            '0%': { transform: 'translateX(0%)' },
                            '100%': { transform: 'translateX(-100%)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Custom Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap');
        
        body { 
            background-color: #000000; 
            color: #f4f4f5; 
            -webkit-font-smoothing: antialiased;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 2px; }
        ::-webkit-scrollbar-track { background: #09090b; }
        ::-webkit-scrollbar-thumb { background: #27272a; }

        /* Animations */
        .animate-enter { animation: enter 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes enter {
            from { opacity: 0; transform: translateY(10px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .glass {
            background: rgba(24, 24, 27, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }
        
        /* Toast Container */
        #toast-container {
            position: fixed;
            top: 1rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            width: 90%;
            max-width: 400px;
            pointer-events: none;
        }
        .toast {
            pointer-events: auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            animation: slideDown 0.3s ease-out forwards;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <div id="toast-container"></div>

    <div id="app" class="max-w-md mx-auto min-h-screen bg-black shadow-2xl overflow-hidden relative border-x border-zinc-800 text-zinc-100 flex flex-col">
        <!-- Content injected by JS -->
    </div>

    <script>
        // --- Configuration ---
        const SITE_NAME = "SYNK STORE";
        // Version constant removed as requested
        const GCASH_QR_URL = "https://upload.wikimedia.org/wikipedia/commons/d/d0/QR_code_for_mobile_English_Wikipedia.svg"; 
        const GCASH_NUMBER = "0917 123 4567";
        const apiKey = ""; // Enter Gemini API Key Here

        const PRODUCTS = [
            {
                id: 1,
                title: "Shein Account (73% off, 469c)",
                tag: "HIGH DEMAND",
                price: 35,
                bulkPrice: 30,
                bulkThreshold: 10,
                description: "Verified account with 73% discount voucher embedded (Cap 469). BONUS: Includes huge 70% off coupon (Cap 1055). Instant delivery.",
                color: "bg-zinc-900"
            },
            {
                id: 2,
                title: "Shein Account (70% off, 410c)",
                tag: "STABLE",
                price: 20,
                bulkPrice: 15,
                bulkThreshold: 10,
                description: "Standard verified account. 70% discount voucher embedded. Cap: 410. Ideal for bulk orders.",
                color: "bg-zinc-900"
            }
        ];

        // --- State Management ---
        const state = {
            view: 'home',
            orders: [],
            selectedProduct: null,
            quantity: 1,
            refNumber: '',
            lastOrderId: null,
            trackerInput: '',
            searchResult: null,
            adminAuth: false,
            adminTab: 'orders',
            activeFulfillmentId: null,
            fulfillmentText: '',
            aiLoading: false,
            aiContent: null
        };

        // --- Helpers ---
        const formatPHP = (amount) => new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP' }).format(amount);
        const generateOrderId = () => 'ORD-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        const formatDate = (dateStr) => new Date(dateStr).toLocaleString('en-US', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
        
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            
            let icon = '';
            if (type === 'success') icon = '<i data-lucide="check-circle" class="w-4 h-4 text-emerald-400"></i>';
            else if (type === 'error') icon = '<i data-lucide="alert-circle" class="w-4 h-4 text-red-400"></i>';
            else icon = '<i data-lucide="info" class="w-4 h-4 text-blue-400"></i>';

            toast.innerHTML = `${icon} <span>${message}</span>`;
            container.appendChild(toast);
            lucide.createIcons();

            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // --- Core Logic ---

        function init() {
            const savedOrders = localStorage.getItem('synk_orders');
            if (savedOrders) state.orders = JSON.parse(savedOrders);
            render();
        }

        function saveOrders() {
            localStorage.setItem('synk_orders', JSON.stringify(state.orders));
        }

        function goHome() {
            setView('home');
        }

        function setView(view) {
            state.view = view;
            if(view === 'home') {
                state.quantity = 1;
                state.refNumber = '';
            }
            render();
        }

        function selectProduct(id) {
            state.selectedProduct = PRODUCTS.find(p => p.id === id);
            state.quantity = 1;
            setView('product');
        }

        function updateQuantity(change) {
            const newQty = state.quantity + change;
            if (newQty >= 1) {
                state.quantity = newQty;
                render();
            }
        }

        function getPrice() {
            if (!state.selectedProduct) return 0;
            return state.quantity >= state.selectedProduct.bulkThreshold 
                ? state.selectedProduct.bulkPrice 
                : state.selectedProduct.price;
        }

        function submitOrder() {
            const refInput = document.getElementById('refNumberInput');
            if (!refInput || !refInput.value.trim()) {
                showToast("Please enter the payment reference number.", "error");
                return;
            }
            
            const newOrder = {
                id: generateOrderId(),
                date: new Date().toISOString(),
                product: state.selectedProduct.title,
                quantity: state.quantity,
                total: getPrice() * state.quantity,
                refNumber: refInput.value.trim(),
                status: 'Processing',
                accounts: [] 
            };

            state.orders.unshift(newOrder);
            state.lastOrderId = newOrder.id;
            saveOrders();
            setView('success');
            showToast("Order submitted successfully", "success");
        }

        function handleTrack() {
            const input = document.getElementById('trackerInputVal');
            if(input) state.trackerInput = input.value.trim();
            
            if(!state.trackerInput) {
                showToast("Please enter an Order ID", "error");
                return;
            }

            const found = state.orders.find(o => o.id === state.trackerInput);
            state.searchResult = found || 'not-found';
            state.aiContent = null;
            render();
        }

        function cancelOrder(id) {
            const order = state.orders.find(o => o.id === id);
            if (!order) return;
            
            const timeDiff = new Date() - new Date(order.date);
            if (timeDiff < 60000) {
                if(confirm('Cancel this order? This action cannot be undone.')) {
                    order.status = 'Cancelled';
                    state.searchResult = order;
                    saveOrders();
                    render();
                    showToast("Order cancelled", "info");
                }
            } else {
                showToast('Cancellation window has expired.', 'error');
            }
        }

        function toggleAccountUsed(orderId, accId) {
            const order = state.orders.find(o => o.id === orderId);
            if(order) {
                const acc = order.accounts.find(a => a.id === accId);
                if(acc) {
                    acc.used = !acc.used;
                    saveOrders();
                    render();
                }
            }
        }

        function requestOtp(orderId, accId) {
            const order = state.orders.find(o => o.id === orderId);
            if(order) {
                const acc = order.accounts.find(a => a.id === accId);
                if(acc) {
                    acc.otpRequest = { status: 'pending', code: null, requestedAt: new Date().toISOString() };
                    saveOrders();
                    render();
                    showToast("OTP Requested. Wait for admin.", "info");
                }
            }
        }

        function handleAdminLogin() {
            const pass = document.getElementById('adminPassInput').value;
            if (pass === 'admin123') {
                state.adminAuth = true;
                render();
                showToast("Welcome back, Admin.", "success");
            } else {
                showToast('Invalid Access Code', 'error');
            }
        }

        function fulfillOrder(id) {
            const text = document.getElementById('fulfillmentTextArea').value;
            if (!text.trim()) return showToast("Please enter accounts", "error");

            const accountLines = text.trim().split('\n').filter(line => line.trim() !== '');
            const newAccounts = accountLines.map((line, index) => ({
                id: `acc-${Date.now()}-${index}`,
                creds: line.trim(),
                used: false,
                otpRequest: { status: 'idle', code: null, requestedAt: null }
            }));

            const order = state.orders.find(o => o.id === id);
            if(order) {
                order.status = 'Completed';
                order.accounts = newAccounts;
                state.activeFulfillmentId = null;
                saveOrders();
                render();
                showToast("Order fulfilled successfully", "success");
            }
        }

        function sendOtp(orderId, accId, code) {
            const order = state.orders.find(o => o.id === orderId);
            if(order) {
                const acc = order.accounts.find(a => a.id === accId);
                if(acc) {
                    acc.otpRequest.status = 'sent';
                    acc.otpRequest.code = code;
                    saveOrders();
                    render();
                    showToast("OTP Sent to user", "success");
                }
            }
        }

        function getPendingOtpCount() {
            let count = 0;
            state.orders.forEach(o => {
                if (o.accounts) {
                    o.accounts.forEach(a => {
                        if (a.otpRequest.status === 'pending') count++;
                    });
                }
            });
            return count;
        }

        async function callGemini(prompt, type) {
            state.aiLoading = true;
            state.aiContent = null;
            render();

            try {
                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                    {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] }),
                    }
                );
                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "System busy.";
                state.aiContent = { type, text };
            } catch (e) {
                console.error(e);
                state.aiContent = { type, text: "Connection error. Check API Key." };
            }
            
            state.aiLoading = false;
            render();
        }

        // --- Render Functions ---

        function renderHeader() {
            return `
            <div class="sticky top-0 z-40 glass border-b border-white/5">
                <div class="flex justify-between items-center h-16 px-5">
                    <div class="flex items-center gap-4">
                        <button class="text-zinc-400 hover:text-white transition-colors"><i data-lucide="menu" class="w-5 h-5"></i></button>
                        <button onclick="window.goHome()" class="font-bold text-xl tracking-tighter italic bg-clip-text text-transparent bg-gradient-to-r from-white to-zinc-500">${SITE_NAME}</button>
                    </div>
                    <div class="flex items-center gap-5">
                        <button onclick="window.setView('tracker')" class="text-zinc-400 hover:text-white transition-colors"><i data-lucide="search" class="w-5 h-5"></i></button>
                        <button onclick="window.setView('admin')" class="text-zinc-400 hover:text-white transition-colors"><i data-lucide="hexagon" class="w-5 h-5"></i></button>
                    </div>
                </div>
            </div>`;
        }

        function renderHome() {
            return `
            <div class="pb-20 animate-enter">
                <!-- Status Bar Updated -->
                <div class="bg-zinc-900/50 border-b border-white/5 py-2 px-4 flex justify-center items-center gap-2 text-[10px] uppercase tracking-widest text-zinc-500 font-mono">
                    <i data-lucide="lock" class="w-3 h-3"></i>
                    All transactions are secured and safe (Manual Process)
                </div>

                <!-- Marquee -->
                <div class="overflow-hidden bg-emerald-900/10 border-b border-emerald-500/10 py-3 relative">
                     <div class="whitespace-nowrap animate-marquee flex gap-8 items-center text-xs font-mono text-emerald-500">
                        <span>• RECENT: User_99 purchased 50x Premium Accounts</span>
                        <span>• STOCK: Available</span>
                        <span>• CONNECTION: Secure</span>
                        <span>• RECENT: User_12 purchased 10x Standard Accounts</span>
                        <span>• RECENT: User_99 purchased 50x Premium Accounts</span>
                        <span>• STOCK: Available</span>
                        <span>• CONNECTION: Secure</span>
                        <span>• RECENT: User_12 purchased 10x Standard Accounts</span>
                     </div>
                     <div class="absolute inset-y-0 left-0 w-8 bg-gradient-to-r from-black to-transparent"></div>
                     <div class="absolute inset-y-0 right-0 w-8 bg-gradient-to-l from-black to-transparent"></div>
                </div>

                <!-- Hero -->
                <div class="p-6 mb-2 relative overflow-hidden group">
                    <div class="relative z-10">
                        <h1 class="text-4xl font-bold leading-none mb-4 tracking-tighter text-white">DIGITAL<br/>ASSETS.</h1>
                        <p class="text-xs text-zinc-400 max-w-[250px] leading-relaxed font-mono">
                            Premium verified accounts delivered instantly to your dashboard. Secure. Fast. Anonymous.
                        </p>
                    </div>
                    <div class="absolute right-0 top-0 w-64 h-64 bg-gradient-to-b from-zinc-800 to-transparent opacity-20 blur-3xl -translate-y-1/2 translate-x-1/2"></div>
                </div>

                <!-- Grid -->
                <div class="px-4">
                    <div class="flex items-center gap-2 mb-6 opacity-50">
                        <i data-lucide="grid" class="w-3 h-3 text-white"></i>
                        <span class="text-[10px] font-bold tracking-[0.2em] uppercase text-zinc-400">AVAILABLE STOCK</span>
                    </div>
                    
                    <div class="grid grid-cols-1 gap-4">
                        ${PRODUCTS.map(p => `
                        <div onclick="window.selectProduct(${p.id})" class="group cursor-pointer bg-zinc-900/50 border border-white/5 hover:border-emerald-500/50 hover:bg-zinc-900 transition-all duration-300 p-4 relative overflow-hidden">
                            <div class="flex gap-5 relative z-10">
                                <div class="w-24 h-24 ${p.color} flex items-center justify-center shrink-0 border border-white/5">
                                    <i data-lucide="package" class="w-10 h-10 opacity-90 group-hover:scale-110 transition-transform duration-500 text-zinc-600"></i>
                                </div>
                                <div class="flex flex-col justify-between py-1 w-full">
                                    <div>
                                        <div class="flex justify-between items-start mb-2">
                                            <h3 class="text-sm font-bold uppercase tracking-wide text-white group-hover:text-emerald-400 transition-colors">${p.title}</h3>
                                        </div>
                                        <div class="flex gap-2 mb-3">
                                            <span class="bg-white/5 text-zinc-400 border border-white/5 text-[9px] font-mono px-2 py-1 uppercase rounded-sm">${p.tag}</span>
                                        </div>
                                    </div>
                                    <div class="flex justify-between items-end">
                                        <div class="flex flex-col">
                                            <span class="text-[10px] text-zinc-500 uppercase font-mono">Price</span>
                                            <span class="text-lg font-bold font-mono text-white">${formatPHP(p.price)}</span>
                                        </div>
                                        <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-emerald-500 group-hover:text-black transition-colors">
                                            <i data-lucide="arrow-up-right" class="w-4 h-4"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        `).join('')}
                    </div>
                </div>
            </div>`;
        }

        function renderProduct() {
            const p = state.selectedProduct;
            const total = getPrice() * state.quantity;
            const isBulk = state.quantity >= p.bulkThreshold;

            return `
            <div class="pb-32 animate-enter flex flex-col h-full">
                <!-- Nav -->
                <div class="p-4">
                    <button onclick="window.goHome()" class="flex items-center gap-2 text-xs font-mono text-zinc-400 hover:text-white transition-colors">
                        <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Catalog
                    </button>
                </div>

                <div class="px-6 flex-1 pt-4">
                    <div class="flex justify-between items-start mb-4">
                        <h1 class="text-2xl font-bold uppercase leading-tight tracking-tight">${p.title}</h1>
                        <span class="font-mono text-emerald-400 text-xs border border-emerald-500/20 bg-emerald-500/10 px-2 py-1">${p.tag}</span>
                    </div>
                    
                    <p class="text-zinc-400 text-sm mb-8 leading-relaxed font-light border-l-2 border-zinc-800 pl-4">${p.description}</p>

                    <!-- Pricing Tier -->
                    <div class="bg-zinc-900/50 border border-white/5 p-5 mb-8 rounded-sm">
                        <div class="flex justify-between items-center mb-3 pb-3 border-b border-white/5 ${!isBulk ? 'text-white' : 'text-zinc-500'}">
                            <span class="text-xs uppercase font-bold tracking-wider">Single Unit</span>
                            <span class="font-mono text-sm">${formatPHP(p.price)}</span>
                        </div>
                        <div class="flex justify-between items-center ${isBulk ? 'text-emerald-400' : 'text-zinc-500'}">
                            <span class="text-xs uppercase font-bold tracking-wider flex items-center gap-2">
                                Bulk Pack (10+) 
                                ${isBulk ? '<span class="animate-pulse">●</span>' : ''}
                            </span>
                            <span class="font-mono text-sm">${formatPHP(p.bulkPrice)}</span>
                        </div>
                    </div>

                    <!-- Quantity Control -->
                    <div class="flex items-center justify-between mb-8">
                        <span class="text-xs font-bold uppercase tracking-[0.2em] text-zinc-500">QUANTITY</span>
                        <div class="flex items-center gap-1 bg-zinc-900 border border-white/10 p-1 rounded-full">
                            <button onclick="window.updateQuantity(-1)" class="w-10 h-10 rounded-full flex items-center justify-center hover:bg-zinc-800 text-white transition-colors">-</button>
                            <span class="w-12 text-center text-sm font-mono font-bold text-emerald-400">${state.quantity}</span>
                            <button onclick="window.updateQuantity(1)" class="w-10 h-10 rounded-full flex items-center justify-center hover:bg-zinc-800 text-white transition-colors">+</button>
                        </div>
                    </div>
                </div>

                <!-- Sticky Footer -->
                <div class="fixed bottom-0 left-0 right-0 glass border-t border-white/10 p-4 safe-area-bottom z-20">
                    <div class="max-w-md mx-auto flex items-center gap-4">
                        <div class="flex-1">
                            <span class="text-[10px] uppercase text-zinc-500 block mb-1 font-mono tracking-wider">Subtotal</span>
                            <span class="text-2xl font-bold font-mono text-white">${formatPHP(total)}</span>
                        </div>
                        <button onclick="window.setView('checkout')" class="flex-1 bg-white text-black font-bold py-4 px-6 text-xs uppercase tracking-wider hover:bg-zinc-200 transition-all flex items-center justify-center gap-2">
                            Proceed to Payment <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            </div>`;
        }

        function renderCheckout() {
            const total = getPrice() * state.quantity;
            return `
            <div class="min-h-screen bg-black pb-20 animate-enter">
                <div class="p-4 border-b border-white/5 flex items-center gap-4 sticky top-0 bg-black/80 backdrop-blur-md z-10">
                    <button onclick="window.setView('product')" class="hover:text-white text-zinc-400 transition-colors"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                    <h2 class="font-mono text-xs uppercase tracking-widest text-white">Secure Checkout</h2>
                </div>

                <div class="p-6">
                    <!-- Receipt Card -->
                    <div class="bg-zinc-50 text-black p-6 mb-8 relative font-mono text-xs shadow-xl transform rotate-1">
                         <!-- Rip effect top -->
                         <div class="absolute top-0 left-0 right-0 h-2 bg-black" style="clip-path: polygon(0 2px, 5px 0, 10px 2px, 15px 0, 20px 2px, 25px 0, 30px 2px, 35px 0, 40px 2px, 45px 0, 50px 2px, 55px 0, 60px 2px, 65px 0, 70px 2px, 75px 0, 80px 2px, 85px 0, 90px 2px, 95px 0, 100% 2px, 100% 100%, 0 100%);"></div>
                         
                         <div class="text-center mb-6 mt-4">
                            <h3 class="font-bold text-lg uppercase tracking-tight">${SITE_NAME}</h3>
                            <p class="text-[10px] uppercase opacity-60">Order Summary</p>
                         </div>
                         
                         <div class="border-b border-dashed border-black/20 pb-4 mb-4">
                            <div class="flex justify-between mb-2">
                                <span class="uppercase">${state.selectedProduct.title}</span>
                                <span class="font-bold">x${state.quantity}</span>
                            </div>
                            <div class="flex justify-between opacity-60 text-[10px]">
                                <span>SKU: ${state.selectedProduct.id.toString().padStart(4, '0')}</span>
                                <span>UNIT: ${formatPHP(getPrice())}</span>
                            </div>
                         </div>

                         <div class="flex justify-between items-end text-lg font-bold mb-6">
                            <span>TOTAL AMOUNT</span>
                            <span>${formatPHP(total)}</span>
                         </div>

                         <div class="text-center opacity-40 text-[9px]">
                            <p>Payment Status: Pending</p>
                            <p>${new Date().toISOString()}</p>
                         </div>
                    </div>

                    <!-- Payment Method -->
                    <div class="mb-8">
                        <div class="flex items-center gap-2 mb-4">
                            <div class="w-2 h-2 bg-white rounded-full"></div>
                            <span class="text-[10px] font-bold uppercase tracking-widest text-zinc-400">Payment Gateway</span>
                        </div>
                        
                        <div class="bg-zinc-900 border border-white/10 p-6 flex flex-col items-center justify-center gap-4 relative overflow-hidden">
                             <div class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9IjAuMDUiLz4KPC9zdmc+')] opacity-10"></div>
                             <div class="bg-white p-2">
                                <img src="${GCASH_QR_URL}" alt="QR" class="w-32 h-32 object-cover mix-blend-multiply" />
                             </div>
                             <div class="text-center relative z-10">
                                <p class="font-mono text-lg font-bold text-white tracking-widest">${GCASH_NUMBER}</p>
                                <p class="text-[10px] uppercase text-zinc-500 mt-1">Scan to transfer funds</p>
                             </div>
                        </div>
                    </div>

                    <!-- Ref Input -->
                    <div>
                        <label class="block text-[10px] font-bold uppercase text-zinc-500 mb-2 tracking-wider">Reference Number</label>
                        <div class="relative">
                            <input type="text" id="refNumberInput" placeholder="0000 0000 0000" class="w-full bg-zinc-900 border border-white/10 py-4 px-4 pl-12 text-sm font-mono text-white focus:outline-none focus:border-emerald-500 transition-colors placeholder-zinc-700" />
                            <i data-lucide="hash" class="w-4 h-4 text-zinc-600 absolute left-4 top-1/2 -translate-y-1/2"></i>
                        </div>
                        
                        <button onclick="window.submitOrder()" class="w-full bg-emerald-500 text-black font-bold py-4 px-4 text-xs uppercase mt-6 hover:bg-emerald-400 transition-all tracking-wider shadow-[0_0_20px_rgba(16,185,129,0.3)]">
                            Confirm Payment
                        </button>
                    </div>
                </div>
            </div>`;
        }

        function renderSuccess() {
            return `
            <div class="min-h-screen flex flex-col items-center justify-center p-8 text-center bg-black animate-enter relative overflow-hidden">
                <!-- Background Glow -->
                <div class="absolute inset-0 bg-emerald-500/5 radial-gradient"></div>

                <div class="w-20 h-20 bg-zinc-900 border border-emerald-500/30 rounded-full flex items-center justify-center mb-8 shadow-[0_0_30px_rgba(16,185,129,0.2)] relative z-10">
                    <i data-lucide="check" class="w-8 h-8 text-emerald-500"></i>
                </div>
                
                <h2 class="text-3xl font-bold tracking-tighter mb-2 text-white relative z-10">Order Received</h2>
                <p class="text-zinc-500 text-xs mb-10 max-w-[250px] leading-relaxed font-mono relative z-10">
                    We have received your payment reference. Your order is being processed. ETA: 10-30m.
                </p>
                
                <div class="bg-zinc-900 border border-dashed border-zinc-700 p-4 w-full mb-8 relative group max-w-xs">
                    <p class="text-[9px] text-zinc-500 uppercase tracking-widest mb-2 font-mono">Order Reference ID</p>
                    <p class="text-xl font-mono font-bold text-white tracking-widest">${state.lastOrderId}</p>
                    <button onclick="navigator.clipboard.writeText('${state.lastOrderId}'); showToast('Copied to clipboard', 'success')" class="absolute right-4 top-1/2 -translate-y-1/2 text-zinc-600 hover:text-white p-2 transition-colors">
                        <i data-lucide="copy" class="w-4 h-4"></i>
                    </button>
                </div>

                <div class="space-y-3 w-full max-w-xs relative z-10">
                    <button onclick="window.setView('tracker')" class="w-full bg-white text-black font-bold py-3 px-4 text-xs uppercase hover:bg-zinc-200 transition-colors tracking-wider">
                        Check Status
                    </button>
                    <button onclick="window.goHome()" class="w-full text-zinc-500 font-bold py-3 px-4 text-xs uppercase hover:text-white transition-colors tracking-wider">
                        Return to Store
                    </button>
                </div>
            </div>`;
        }

        function renderTracker() {
            const res = state.searchResult;
            let content = '';

            if (!res) {
                 content = ``;
            } else if (res === 'not-found') {
                content = `
                <div class="animate-enter text-center p-8 text-zinc-500 border border-dashed border-zinc-800 bg-zinc-900/30 mt-4">
                    <i data-lucide="search-x" class="w-8 h-8 mx-auto mb-3 opacity-50"></i>
                    <p class="text-xs font-mono">Error: Order not found</p>
                </div>`;
            } else {
                const isProcessing = res.status === 'Processing';
                const isCompleted = res.status === 'Completed';
                const timeDiff = new Date() - new Date(res.date);
                const canCancel = isProcessing && timeDiff < 60000;

                let accountsHtml = '';
                if(isCompleted && res.accounts && res.accounts.length > 0) {
                    accountsHtml = `
                    <div class="mt-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xs font-bold uppercase tracking-widest flex items-center gap-2 text-zinc-400"><i data-lucide="terminal" class="w-4 h-4"></i> Account Credentials</h3>
                            <button onclick="window.handleTrack()" class="text-zinc-600 hover:text-white transition-colors"><i data-lucide="refresh-cw" class="w-3 h-3"></i></button>
                        </div>
                        <div class="space-y-3">
                            ${res.accounts.map((acc, idx) => `
                            <div class="bg-zinc-900 border ${acc.used ? 'border-zinc-800 opacity-50' : 'border-emerald-500/20'} p-4 relative overflow-hidden group transition-all">
                                <div class="flex justify-between items-center mb-3">
                                    <span class="text-[10px] text-zinc-500 font-mono">Account #${idx + 1}</span>
                                    <button onclick="window.toggleAccountUsed('${res.id}', '${acc.id}')" class="text-[9px] ${acc.used ? 'text-zinc-500' : 'text-zinc-400 hover:text-white'} uppercase font-bold flex items-center gap-1 transition-colors">
                                        ${acc.used ? 'Undo' : 'Mark as Used'}
                                    </button>
                                </div>
                                <div class="font-mono text-sm mb-4 select-all break-all ${acc.used ? 'line-through text-zinc-600' : 'text-emerald-500'}">${acc.creds}</div>
                                
                                <div class="bg-black/50 p-2 rounded flex items-center justify-between gap-3 border border-white/5">
                                    ${acc.otpRequest.status === 'sent' ? `
                                    <span class="text-[10px] font-bold text-zinc-500 uppercase">2FA CODE:</span>
                                    <div class="flex items-center gap-2">
                                        <span class="font-mono font-bold text-white text-lg tracking-widest">${acc.otpRequest.code}</span>
                                        <i data-lucide="copy" class="w-3 h-3 text-zinc-500 cursor-pointer hover:text-white" onclick="navigator.clipboard.writeText('${acc.otpRequest.code}'); showToast('Code copied', 'success')"></i>
                                    </div>` : acc.otpRequest.status === 'pending' ? `
                                    <div class="flex items-center gap-2 w-full text-yellow-500/80 justify-center py-1">
                                        <i data-lucide="loader" class="w-3 h-3 animate-spin"></i>
                                        <span class="text-[10px] font-bold uppercase tracking-wide font-mono">Waiting for Admin...</span>
                                    </div>` : `
                                    <div class="flex items-center justify-between w-full">
                                        <span class="text-[10px] text-zinc-500 uppercase">Login Verification (OTP)</span>
                                        <button onclick="window.requestOtp('${res.id}', '${acc.id}')" class="bg-white/10 hover:bg-white/20 text-white text-[9px] font-bold px-3 py-1 uppercase transition-colors rounded-sm tracking-wide">Request OTP</button>
                                    </div>`}
                                </div>
                            </div>
                            `).join('')}
                        </div>
                    </div>`;
                }

                let aiSection = '';
                if(isCompleted) {
                    aiSection = `
                    <div class="mt-6 pt-6 border-t border-dashed border-zinc-800">
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-[10px] font-bold uppercase tracking-widest flex items-center gap-2 text-indigo-400 glow-text"><i data-lucide="bot" class="w-3 h-3"></i> AI Tools</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="window.callGemini('Provide 3 critical, strict bullet points on how to safely use a ${res.product} without getting flagged or banned. Tone: Professional, secretive, like a mission briefing. Max 50 words.', 'security')" 
                                class="bg-indigo-500/10 border border-indigo-500/20 text-indigo-300 hover:bg-indigo-500/20 font-bold py-3 px-3 text-[9px] uppercase transition-colors disabled:opacity-50" ${state.aiLoading ? 'disabled' : ''}>
                                ${state.aiLoading && state.aiContent?.type === 'security' ? 'Decrypting...' : 'Security Guide'}
                            </button>
                            <button onclick="window.callGemini('Write a short, high-energy social media caption for a reseller selling ${res.product}. Use emojis. Do not mention specific prices. Create a sense of urgency. Max 30 words.', 'reseller')" 
                                class="bg-zinc-800 border border-zinc-700 text-zinc-300 hover:bg-zinc-700 font-bold py-3 px-3 text-[9px] uppercase transition-colors disabled:opacity-50" ${state.aiLoading ? 'disabled' : ''}>
                                ${state.aiLoading && state.aiContent?.type === 'reseller' ? 'Drafting...' : 'Marketing Copy'}
                            </button>
                        </div>
                        ${state.aiContent ? `
                        <div class="mt-4 bg-zinc-900 border border-white/10 p-4 text-xs font-mono relative overflow-hidden animate-enter">
                            <div class="absolute top-0 right-0 p-2 opacity-30"><i data-lucide="${state.aiContent.type === 'security' ? 'shield-check' : 'share-2'}" class="w-4 h-4 text-white"></i></div>
                            <p class="uppercase text-[9px] text-zinc-500 mb-2 border-b border-zinc-800 pb-2 flex items-center gap-2">
                                <span class="w-1.5 h-1.5 bg-green-500 rounded-full"></span>
                                ${state.aiContent.type === 'security' ? 'Security Guide' : 'Marketing Copy'}
                            </p>
                            <div class="whitespace-pre-wrap leading-relaxed text-zinc-300">${state.aiContent.text}</div>
                        </div>` : ''}
                    </div>`;
                }

                content = `
                <div class="animate-enter mt-6 pb-20">
                    <div class="bg-zinc-900/50 border border-white/5 p-6 relative overflow-hidden backdrop-blur-sm">
                        <!-- Status Bar -->
                        <div class="absolute top-0 left-0 w-1 h-full ${isCompleted ? 'bg-emerald-500' : (res.status === 'Cancelled' ? 'bg-red-500' : 'bg-yellow-500')}"></div>
                        
                        <div class="flex justify-between items-start mb-6 pl-2">
                            <div>
                                <h3 class="font-bold text-sm tracking-tight mb-1 text-white">${res.id}</h3>
                                <p class="text-[10px] text-zinc-500 font-mono">${formatDate(res.date)}</p>
                            </div>
                            <span class="${isCompleted ? 'text-emerald-400 bg-emerald-500/10 border-emerald-500/20' : 'text-yellow-400 bg-yellow-500/10 border-yellow-500/20'} border text-[9px] font-bold px-2 py-1 uppercase tracking-wider">${res.status}</span>
                        </div>
                        
                        <div class="border-t border-dashed border-zinc-800 pt-4 space-y-2 pl-2">
                            <div class="flex justify-between text-xs">
                                <span class="text-zinc-500 uppercase tracking-wider text-[10px]">Product</span>
                                <span class="font-medium text-white truncate max-w-[150px]">${res.product}</span>
                            </div>
                             <div class="flex justify-between text-xs">
                                <span class="text-zinc-500 uppercase tracking-wider text-[10px]">Total Amount</span>
                                <span class="font-bold font-mono text-white">${formatPHP(res.total)}</span>
                            </div>
                        </div>

                        ${canCancel ? `
                        <div class="mt-6 pl-2">
                            <button onclick="window.cancelOrder('${res.id}')" class="w-full bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20 font-bold py-3 px-3 text-[10px] uppercase transition-colors tracking-wide">
                                Cancel Order (Undo)
                            </button>
                            <p class="text-[9px] text-zinc-600 text-center mt-2 font-mono">TIMER: < 60s remaining</p>
                        </div>` : ''}
                        ${aiSection}
                    </div>
                    ${accountsHtml}
                </div>`;
            }

            return `
            <div class="min-h-screen bg-black font-sans pb-20">
                <div class="p-4 border-b border-white/5 flex items-center gap-4 sticky top-0 bg-black/80 backdrop-blur-md z-10">
                    <button onclick="window.goHome()" class="hover:text-white text-zinc-400 transition-colors"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                    <span class="text-xs font-bold uppercase tracking-[0.2em] text-zinc-300">Order Lookup</span>
                </div>
                <div class="p-6 max-w-md mx-auto">
                    <div class="mb-6">
                        <label class="block text-[10px] font-bold uppercase text-zinc-500 mb-2 tracking-wider">Enter Order ID</label>
                        <div class="relative">
                            <input type="text" id="trackerInputVal" value="${state.trackerInput}" placeholder="ORD-XXXXXXXX" class="w-full bg-zinc-900 border border-white/10 py-3 px-4 pl-10 text-sm font-mono text-white focus:outline-none focus:border-white/30 transition-colors placeholder-zinc-700" />
                            <i data-lucide="hash" class="w-4 h-4 text-zinc-600 absolute left-3 top-1/2 -translate-y-1/2"></i>
                        </div>
                        <button onclick="window.handleTrack()" class="w-full bg-white text-black font-bold py-3 px-4 text-xs uppercase mt-3 hover:bg-zinc-200 transition-colors tracking-wider">Track Order</button>
                    </div>
                    ${content}
                </div>
            </div>`;
        }

        function renderAdmin() {
            if (!state.adminAuth) {
                return `
                <div class="min-h-screen bg-black text-white font-sans flex items-center justify-center p-6">
                    <div class="bg-zinc-900 border border-white/10 p-8 max-w-sm w-full relative overflow-hidden">
                         <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-emerald-500 to-transparent opacity-50"></div>
                         <div class="flex justify-between items-center mb-8">
                            <h3 class="font-bold text-center uppercase tracking-[0.2em] text-sm">Administration</h3>
                            <button onclick="window.goHome()" class="text-[10px] text-zinc-500 hover:text-white uppercase">Exit</button>
                         </div>
                        <div class="mb-6">
                            <label class="block text-[10px] font-bold uppercase text-zinc-500 mb-2 tracking-wider">Password</label>
                            <input type="password" id="adminPassInput" class="w-full bg-black border border-white/10 py-3 px-4 text-sm font-mono focus:outline-none focus:border-emerald-500/50 transition-colors text-white" />
                        </div>
                        <button onclick="window.handleAdminLogin()" class="w-full bg-white text-black font-bold py-3 px-4 text-xs uppercase hover:bg-zinc-200 tracking-wider">Authenticate</button>
                        <p class="text-center mt-6 text-[10px] text-zinc-700 font-mono">KEY: admin123</p>
                    </div>
                </div>`;
            }

            const pending = state.orders.filter(o => o.status === 'Processing').length;
            const revenue = state.orders.reduce((acc, cur) => acc + cur.total, 0);
            const pendingOtp = getPendingOtpCount();

            // Orders Tab Content
            let tabContent = '';
            if (state.adminTab === 'orders') {
                tabContent = `
                <div class="bg-zinc-900 border border-white/5 overflow-hidden">
                    <table class="w-full text-left">
                        <tbody class="divide-y divide-white/5">
                            ${state.orders.map(order => `
                            <tr class="hover:bg-white/5 group transition-colors">
                                <td class="p-4">
                                    <div class="flex items-center gap-2">
                                        <span class="font-bold text-xs text-white font-mono">${order.id}</span>
                                        ${order.status === 'Processing' ? '<span class="w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse"></span>' : ''}
                                    </div>
                                    <div class="text-[10px] text-zinc-500 font-mono mt-1 opacity-60">Ref: ${order.refNumber}</div>
                                    <div class="text-[10px] text-zinc-400 mt-1 uppercase tracking-wide">${order.product} <span class="text-zinc-600">x${order.quantity}</span></div>
                                </td>
                                <td class="p-4">
                                    <span class="${order.status === 'Completed' ? 'text-emerald-400 border-emerald-500/20 bg-emerald-500/5' : (order.status === 'Cancelled' ? 'text-red-400 border-red-500/20 bg-red-500/5' : 'text-yellow-400 border-yellow-500/20 bg-yellow-500/5')} border text-[9px] font-bold px-2 py-1 uppercase rounded-sm">${order.status}</span>
                                </td>
                                <td class="p-4 text-right">
                                    ${order.status === 'Processing' ? `
                                        <button onclick="state.activeFulfillmentId = '${order.id}'; render()" class="bg-white text-black hover:bg-zinc-200 px-3 py-1 text-[10px] uppercase font-bold tracking-wide">Fulfill</button>
                                    ` : order.status === 'Completed' ? '<span class="text-[10px] text-zinc-500 font-bold uppercase"><i data-lucide="check" class="w-3 h-3 inline"></i> Done</span>' : ''}
                                </td>
                            </tr>
                            ${state.activeFulfillmentId === order.id ? `
                            <tr>
                                <td colspan="3" class="bg-zinc-800/50 p-6 border-y border-white/5 animate-enter">
                                    <h4 class="text-[10px] font-bold uppercase mb-2 text-zinc-400 tracking-wider">Add Accounts (Line Separated)</h4>
                                    <textarea id="fulfillmentTextArea" class="w-full bg-black border border-white/10 p-3 text-xs font-mono h-32 mb-4 focus:border-emerald-500/50 focus:outline-none text-white" placeholder="user:pass..."></textarea>
                                    <div class="flex justify-end gap-3">
                                        <button onclick="state.activeFulfillmentId = null; render()" class="text-zinc-500 hover:text-white text-xs font-bold uppercase transition-colors">Cancel</button>
                                        <button onclick="window.fulfillOrder('${order.id}')" class="bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 text-[10px] uppercase font-bold tracking-wide">Confirm & Send</button>
                                    </div>
                                </td>
                            </tr>` : ''}
                            `).join('')}
                        </tbody>
                    </table>
                </div>`;
            } else {
                // OTP Tab Content
                const pendingReqs = [];
                state.orders.forEach(o => {
                    if (o.accounts) o.accounts.forEach((a, idx) => {
                        if (a.otpRequest.status === 'pending') pendingReqs.push({ orderId: o.id, accId: a.id, creds: a.creds, idx: idx + 1, reqAt: a.otpRequest.requestedAt });
                    });
                });

                if (pendingReqs.length > 0) {
                    tabContent = `
                    <div class="bg-zinc-900 border border-white/5 divide-y divide-white/5">
                        ${pendingReqs.map(req => `
                        <div class="p-4 bg-yellow-500/5 animate-enter">
                            <div class="mb-3">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="font-bold text-xs text-white font-mono">${req.orderId}</span>
                                    <span class="text-[9px] border border-white/10 px-1 text-zinc-400 uppercase font-bold">Slot #${req.idx}</span>
                                </div>
                                <div class="font-mono text-xs px-2 py-1 inline-block bg-black border border-white/10 text-emerald-500 rounded-sm mb-1">${req.creds}</div>
                                <div class="flex items-center gap-1 text-[10px] text-zinc-500"><i data-lucide="clock" class="w-3 h-3"></i> T+ ${Math.floor((new Date() - new Date(req.reqAt)) / 60000)}m</div>
                            </div>
                            <div class="flex gap-2 items-center bg-black p-1 pr-2 rounded border border-white/10">
                                <input type="text" id="otp-input-${req.accId}" placeholder="Enter 2FA Code" class="bg-transparent p-2 text-sm w-full focus:outline-none font-mono text-white placeholder-zinc-700" />
                                <button onclick="window.sendOtp('${req.orderId}', '${req.accId}', document.getElementById('otp-input-${req.accId}').value)" class="text-emerald-500 hover:text-emerald-400 p-2"><i data-lucide="send" class="w-4 h-4"></i></button>
                            </div>
                        </div>
                        `).join('')}
                    </div>`;
                } else {
                    tabContent = `<div class="p-12 text-center text-zinc-600 bg-zinc-900 border border-white/5"><p class="text-xs font-bold uppercase tracking-widest">No pending OTP requests</p></div>`;
                }
            }

            return `
            <div class="min-h-screen bg-black text-white font-sans">
                <div class="bg-black border-b border-white/10 p-4 flex justify-between items-center sticky top-0 z-50">
                    <h2 class="font-black text-sm tracking-[0.2em] flex items-center gap-2 text-zinc-300">ADMIN PANEL <span class="bg-red-900/50 text-red-200 border border-red-500/30 px-1 text-[9px] rounded-sm">V3.0</span></h2>
                    <button onclick="window.goHome()" class="text-[10px] font-bold hover:text-emerald-400 uppercase tracking-wider transition-colors">Logout</button>
                </div>
                <div class="max-w-5xl mx-auto p-4">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-zinc-900 p-4 border border-white/5"><p class="text-[9px] text-zinc-500 uppercase font-bold tracking-widest">Gross Rev</p><p class="text-xl font-bold font-mono text-white">${formatPHP(revenue)}</p></div>
                        <div class="bg-zinc-900 p-4 border border-white/5"><p class="text-[9px] text-zinc-500 uppercase font-bold tracking-widest">Total Tx</p><p class="text-xl font-bold text-white">${state.orders.length}</p></div>
                        <div class="bg-zinc-900 p-4 border border-white/5"><p class="text-[9px] text-zinc-500 uppercase font-bold tracking-widest">Pending</p><p class="text-xl font-bold text-yellow-500">${pending}</p></div>
                        <div onclick="state.adminTab = 'otp'; render()" class="bg-zinc-900 p-4 border cursor-pointer hover:border-emerald-500/30 transition-colors ${pendingOtp > 0 ? 'border-red-500/50 shadow-[0_0_15px_rgba(239,68,68,0.1)]' : 'border-white/5'}">
                            <p class="text-[9px] text-zinc-500 uppercase font-bold flex justify-between tracking-widest">OTP Requests <i data-lucide="radio" class="w-3 h-3"></i></p>
                            <p class="text-xl font-bold text-red-500">${pendingOtp}</p>
                        </div>
                    </div>
                    
                    <div class="flex gap-6 mb-6 border-b border-white/5 pb-1 px-2">
                        <button onclick="state.adminTab = 'orders'; render()" class="text-[10px] font-bold uppercase pb-3 px-1 transition-all tracking-widest ${state.adminTab === 'orders' ? 'border-b-2 border-white text-white' : 'text-zinc-600 hover:text-zinc-400'}">Orders</button>
                        <button onclick="state.adminTab = 'otp'; render()" class="text-[10px] font-bold uppercase pb-3 px-1 transition-all tracking-widest flex items-center gap-2 ${state.adminTab === 'otp' ? 'border-b-2 border-white text-white' : 'text-zinc-600 hover:text-zinc-400'}">OTP Codes ${pendingOtp > 0 ? `<span class="bg-red-500 text-white px-1.5 rounded-full text-[9px] animate-pulse">${pendingOtp}</span>` : ''}</button>
                    </div>
                    ${tabContent}
                </div>
            </div>`;
        }

        // --- Main Render Loop ---
        function render() {
            const app = document.getElementById('app');
            let html = '';

            if (state.view === 'admin') {
                html = renderAdmin();
            } else {
                html = renderHeader();
                if (state.view === 'home') html += renderHome();
                else if (state.view === 'product') html += renderProduct();
                else if (state.view === 'checkout') html += renderCheckout();
                else if (state.view === 'success') html += renderSuccess();
                else if (state.view === 'tracker') html += renderTracker();
            }

            app.innerHTML = html;
            lucide.createIcons();
        }

        // Expose functions to window for inline onclick handlers
        window.goHome = goHome;
        window.setView = setView;
        window.selectProduct = selectProduct;
        window.updateQuantity = updateQuantity;
        window.submitOrder = submitOrder;
        window.handleTrack = handleTrack;
        window.cancelOrder = cancelOrder;
        window.toggleAccountUsed = toggleAccountUsed;
        window.requestOtp = requestOtp;
        window.handleAdminLogin = handleAdminLogin;
        window.fulfillOrder = fulfillOrder;
        window.sendOtp = sendOtp;
        window.callGemini = callGemini;
        window.showToast = showToast;

        // --- Initialization ---
        init();

    </script>
</body>
</html>
